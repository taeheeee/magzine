{"ast":null,"code":"import { createAction, handleActions } from \"redux-actions\";\nimport { produce } from \"immer\"; // 불변성을 유지하기 위해서 immer사용\n\nimport { firestore, storage } from \"../../shared/firebase\";\nimport moment from \"moment\";\nimport { actionCreators as imageActions } from \"./image\"; // 1번순서)액션타입\n\nconst SET_POST = \"SET_POST\";\nconst ADD_POST = \"ADD_POST\";\nconst EDIT_POST = \"EDIT_POST\"; // 2번순서)액션생성자\n\nconst setPost = createAction(SET_POST, post_list => ({\n  post_list\n}));\nconst addPost = createAction(ADD_POST, post => ({\n  post\n}));\nconst editPost = createAction(EDIT_POST, (post_id, post) => ({\n  post_id,\n  post\n})); // 3번순서)이니셜스테이트(리듀서가 사용할)\n\nconst initialState = {\n  list: []\n};\nconst initialPost = {\n  // id: 0,\n  // user_info: {\n  //     user_name: \"mean0\",\n  //     user_profile:\n  //         \"https://www.allkpop.com/upload/2021/12/content/231225/web_data/allkpop_1640280755_untitled-1.jpg\",\n  // },\n  image_url: \"data:image/png;base64,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\",\n  contents: \"고양이네요!\",\n  comment_cnt: 0,\n  insert_dt: moment().format(\"YYYY-MM-DD hh:mm:ss\")\n};\n\nconst editPostFB = function () {\n  let post_id = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n  let post = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return function (dispatch, getState, _ref) {\n    let {\n      history\n    } = _ref;\n\n    if (!post_id) {\n      console.log(\"게시물 정보가 없어요!\");\n      return;\n    }\n\n    const _image = getState().image.preview;\n\n    const _post_idx = getState().post.list.findIndex(p => p.id === post_id);\n\n    const _post = getState().post.list[_post_idx];\n\n    console.log(_post);\n    const postDB = firestore.collection(\"post\");\n\n    if (_image === _post.image_url) {\n      postDB.doc(post_id).update(post).then(doc => {\n        dispatch(editPost(post_id, { ...post\n        }));\n        history.replace(\"/\");\n      });\n      return;\n    } else {\n      const user_id = getState().user.user.uid;\n\n      const _upload = storage.ref(`images/${user_id}_${new Date().getTime()}`).putString(_image, \"data_url\");\n\n      _upload.then(snapshot => {\n        snapshot.ref.getDownloadURL().then(url => {\n          console.log(url);\n          return url;\n        }).then(url => {\n          postDB.doc(post_id).update({ ...post,\n            image_url: url\n          }).then(doc => {\n            dispatch(editPost(post_id, { ...post,\n              image_url: url\n            }));\n            history.replace(\"/\");\n          });\n        }).catch(err => {\n          window.alert(\"앗! 이미지 업로드에 문제가 있어요!\");\n          console.log(\"앗! 이미지 업로드에 문제가 있어요!\", err);\n        });\n      });\n    }\n  };\n}; // firebase에 포스트 추가하는 기능\n\n\nconst addPostFB = function () {\n  let contents = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n  return function (dispatch, getState, _ref2) {\n    let {\n      history\n    } = _ref2;\n    // firebase에 추가를 하려면 추가할데이터의 모양을 알아야한다.\n    const postDB = firestore.collection(\"post\");\n    const _user = getState().user.user;\n    console.log(_user);\n    const user_info = {\n      user_name: _user.user_name,\n      user_id: _user.uid,\n      user_profile: _user.user_profile\n    };\n    console.log(user_info);\n    const _post = { ...initialPost,\n      // 22번째 initialPost값들이 들어온다.그리고\n      contents: contents,\n      insert_dt: moment().format(\"YYYY-MM-DD hh:mm:ss\")\n    }; // getState()로 store의 상태값에 접근할 수 있다.\n\n    const _image = getState().image.preview;\n    console.log(typeof _image);\n    console.log(_image); // 중복된 파일명이 생기지 않게 하기위해서 => 유저의uid와지금시간엮어서 파일명만들기\n\n    const _upload = storage.ref(`images/${user_info.user_id}_${new Date().getTime()}`).putString(_image, \"data_url\");\n\n    _upload.then(snapshot => {\n      snapshot.ref.getDownloadURL().then(url => {\n        console.log(url);\n        return url;\n      }).then(url => {\n        //추가하는작업\n        postDB.add({ ...user_info,\n          ..._post,\n          image_url: url\n        }).then(doc => {\n          // 리덕스에서 관리하는 데이터타입과,firestore에 넣는\n          // 데이터 모양새가 달라서 모양새 맞춰주는거 까먹지말기\n          let post = {\n            user_info,\n            ..._post,\n            id: doc.id,\n            image_url: url\n          };\n          console.log(post);\n          dispatch(addPost(post));\n          history.replace(\"/\");\n          dispatch(imageActions.setPreview(null));\n        }).catch(err => {\n          // 에러가 났을때\n          window.alert(\"앗! 포스트 작성에 문제가 있어요!\");\n          console.log(\"post 작성 실패!\", err);\n        });\n      }).catch(err => {\n        window.alert(\"앗! 이미지 없로드에 문제가 있어요!\");\n        console.log(\"앗! 이미지 업로드에 문제가 있어요!\", err);\n      });\n    });\n  };\n}; // &1)firebase 사이트에서 post컬렉션만든후\n//&2)firebase에서 포스트 가져오기\n\n\nconst getPostFB = () => {\n  return function (dispatch, getState, _ref3) {\n    let {\n      history\n    } = _ref3;\n    // firebase db에 접근하기\n    const postDB = firestore.collection(\"post\");\n    let query = postDB.orderBy;\n    return; // 그다음 데이터 전부 가져오기\n\n    postDB.get().then(docs => {\n      // 가져온다음\n      let post_list = [];\n      docs.forEach(doc => {\n        // firestore에서 가지고 온 값들을 _post에\n        let _post = doc.data(); //[\"commenct_cnt\", \"content\", ...](딕셔너리의 키값들로 배열을 만들어주어라)\n\n\n        let post = Object.keys(_post).reduce((acc, cur) => {\n          //   3-3강의\n          if (cur.indexOf(\"user_\") !== -1) {\n            return { ...acc,\n              user_info: { ...acc.user_info,\n                [cur]: _post[cur]\n              }\n            };\n          }\n\n          return { ...acc,\n            [cur]: _post[cur]\n          };\n        }, {\n          id: doc.id,\n          user_info: {}\n        });\n        post_list.push(post);\n      });\n      console.log(post_list);\n      dispatch(setPost(post_list));\n    });\n  };\n}; // 4번순서)리듀서만들기\n\n\nexport default handleActions({\n  [SET_POST]: (state, action) => // 어떤처리를 해줄지 적어주기\n  produce(state, draft => {\n    // 위에꺼가지고 어떤처리할지\n    draft.list = action.payload.post_list;\n  }),\n  [ADD_POST]: (state, action) => produce(state, draft => {\n    // unshift는 배열 맨 앞에 데이터를 넣어줘요!\n    draft.list.unshift(action.payload.post);\n  }),\n  [EDIT_POST]: (state, action) => produce(state, draft => {\n    let idx = draft.list.findIndex(p => p.id === action.payload.post_id);\n    draft.list[idx] = { ...draft.list[idx],\n      ...action.payload.post\n    };\n  })\n}, initialState); // &3)export하기\n\nconst actionCreators = {\n  setPost,\n  addPost,\n  editPost,\n  getPostFB,\n  addPostFB,\n  editPostFB\n};\nexport { actionCreators };","map":{"version":3,"sources":["C:/Users/coms/OneDrive/문서/GitHub/hanghae-react-intensive/week2/src/redux/modules/post.js"],"names":["createAction","handleActions","produce","firestore","storage","moment","actionCreators","imageActions","SET_POST","ADD_POST","EDIT_POST","setPost","post_list","addPost","post","editPost","post_id","initialState","list","initialPost","image_url","contents","comment_cnt","insert_dt","format","editPostFB","dispatch","getState","history","console","log","_image","image","preview","_post_idx","findIndex","p","id","_post","postDB","collection","doc","update","then","replace","user_id","user","uid","_upload","ref","Date","getTime","putString","snapshot","getDownloadURL","url","catch","err","window","alert","addPostFB","_user","user_info","user_name","user_profile","add","setPreview","getPostFB","query","orderBy","get","docs","forEach","data","Object","keys","reduce","acc","cur","indexOf","push","state","action","draft","payload","unshift","idx"],"mappings":"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","sourcesContent":["import { createAction, handleActions } from \"redux-actions\";\r\nimport { produce } from \"immer\";\r\n// 불변성을 유지하기 위해서 immer사용\r\nimport { firestore, storage } from \"../../shared/firebase\";\r\nimport moment from \"moment\";\r\n\r\nimport { actionCreators as imageActions } from \"./image\";\r\n\r\n// 1번순서)액션타입\r\nconst SET_POST = \"SET_POST\";\r\nconst ADD_POST = \"ADD_POST\";\r\nconst EDIT_POST = \"EDIT_POST\";\r\n\r\n// 2번순서)액션생성자\r\nconst setPost = createAction(SET_POST, (post_list) => ({ post_list }));\r\nconst addPost = createAction(ADD_POST, (post) => ({ post }));\r\nconst editPost = createAction(EDIT_POST, (post_id, post) => ({\r\n  post_id,\r\n  post,\r\n}));\r\n// 3번순서)이니셜스테이트(리듀서가 사용할)\r\nconst initialState = {\r\n  list: [],\r\n};\r\n\r\nconst initialPost = {\r\n  // id: 0,\r\n  // user_info: {\r\n  //     user_name: \"mean0\",\r\n  //     user_profile:\r\n  //         \"https://www.allkpop.com/upload/2021/12/content/231225/web_data/allkpop_1640280755_untitled-1.jpg\",\r\n  // },\r\n  image_url:\r\n    \"data:image/png;base64,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\",\r\n  contents: \"고양이네요!\",\r\n  comment_cnt: 0,\r\n  insert_dt: moment().format(\"YYYY-MM-DD hh:mm:ss\"),\r\n};\r\n\r\nconst editPostFB = (post_id = null, post = {}) => {\r\n  return function (dispatch, getState, { history }) {\r\n    if (!post_id) {\r\n      console.log(\"게시물 정보가 없어요!\");\r\n      return;\r\n    }\r\n\r\n    const _image = getState().image.preview;\r\n\r\n    const _post_idx = getState().post.list.findIndex((p) => p.id === post_id);\r\n    const _post = getState().post.list[_post_idx];\r\n\r\n    console.log(_post);\r\n\r\n    const postDB = firestore.collection(\"post\");\r\n\r\n    if (_image === _post.image_url) {\r\n      postDB\r\n        .doc(post_id)\r\n        .update(post)\r\n        .then((doc) => {\r\n          dispatch(editPost(post_id, { ...post }));\r\n          history.replace(\"/\");\r\n        });\r\n\r\n      return;\r\n    } else {\r\n      const user_id = getState().user.user.uid;\r\n      const _upload = storage\r\n        .ref(`images/${user_id}_${new Date().getTime()}`)\r\n        .putString(_image, \"data_url\");\r\n\r\n      _upload.then((snapshot) => {\r\n        snapshot.ref\r\n          .getDownloadURL()\r\n          .then((url) => {\r\n            console.log(url);\r\n\r\n            return url;\r\n          })\r\n          .then((url) => {\r\n            postDB\r\n              .doc(post_id)\r\n              .update({ ...post, image_url: url })\r\n              .then((doc) => {\r\n                dispatch(editPost(post_id, { ...post, image_url: url }));\r\n                history.replace(\"/\");\r\n              });\r\n          })\r\n          .catch((err) => {\r\n            window.alert(\"앗! 이미지 업로드에 문제가 있어요!\");\r\n            console.log(\"앗! 이미지 업로드에 문제가 있어요!\", err);\r\n          });\r\n      });\r\n    }\r\n  };\r\n};\r\n// firebase에 포스트 추가하는 기능\r\nconst addPostFB = (contents = \"\") => {\r\n  return function (dispatch, getState, { history }) {\r\n    // firebase에 추가를 하려면 추가할데이터의 모양을 알아야한다.\r\n    const postDB = firestore.collection(\"post\");\r\n\r\n    const _user = getState().user.user;\r\n    console.log(_user);\r\n    const user_info = {\r\n      user_name: _user.user_name,\r\n      user_id: _user.uid,\r\n      user_profile: _user.user_profile,\r\n    };\r\n\r\n    console.log(user_info);\r\n    const _post = {\r\n      ...initialPost,\r\n      // 22번째 initialPost값들이 들어온다.그리고\r\n      contents: contents,\r\n      insert_dt: moment().format(\"YYYY-MM-DD hh:mm:ss\"),\r\n    };\r\n\r\n    // getState()로 store의 상태값에 접근할 수 있다.\r\n    const _image = getState().image.preview;\r\n    console.log(typeof _image);\r\n    console.log(_image);\r\n\r\n    // 중복된 파일명이 생기지 않게 하기위해서 => 유저의uid와지금시간엮어서 파일명만들기\r\n    const _upload = storage\r\n      .ref(`images/${user_info.user_id}_${new Date().getTime()}`)\r\n      .putString(_image, \"data_url\");\r\n\r\n    _upload.then((snapshot) => {\r\n      snapshot.ref\r\n        .getDownloadURL()\r\n        .then((url) => {\r\n          console.log(url);\r\n          return url;\r\n        })\r\n        .then((url) => {\r\n          //추가하는작업\r\n          postDB\r\n            .add({ ...user_info, ..._post, image_url: url })\r\n            .then((doc) => {\r\n              // 리덕스에서 관리하는 데이터타입과,firestore에 넣는\r\n              // 데이터 모양새가 달라서 모양새 맞춰주는거 까먹지말기\r\n              let post = {\r\n                user_info,\r\n                ..._post,\r\n                id: doc.id,\r\n                image_url: url,\r\n              };\r\n              console.log(post);\r\n              dispatch(addPost(post));\r\n              history.replace(\"/\");\r\n              dispatch(imageActions.setPreview(null));\r\n            })\r\n            .catch((err) => {\r\n              // 에러가 났을때\r\n              window.alert(\"앗! 포스트 작성에 문제가 있어요!\");\r\n              console.log(\"post 작성 실패!\", err);\r\n            });\r\n        })\r\n        .catch((err) => {\r\n          window.alert(\"앗! 이미지 없로드에 문제가 있어요!\");\r\n          console.log(\"앗! 이미지 업로드에 문제가 있어요!\", err);\r\n        });\r\n    });\r\n  };\r\n};\r\n// &1)firebase 사이트에서 post컬렉션만든후\r\n//&2)firebase에서 포스트 가져오기\r\nconst getPostFB = () => {\r\n  return function (dispatch, getState, { history }) {\r\n    // firebase db에 접근하기\r\n    const postDB = firestore.collection(\"post\");\r\n\r\n\r\n    let query = postDB.orderBy\r\n    return;\r\n    // 그다음 데이터 전부 가져오기\r\n    postDB.get().then((docs) => {\r\n      // 가져온다음\r\n      let post_list = [];\r\n\r\n      docs.forEach((doc) => {\r\n        // firestore에서 가지고 온 값들을 _post에\r\n        let _post = doc.data();\r\n\r\n        //[\"commenct_cnt\", \"content\", ...](딕셔너리의 키값들로 배열을 만들어주어라)\r\n        let post = Object.keys(_post).reduce(\r\n          (acc, cur) => {\r\n            //   3-3강의\r\n            if (cur.indexOf(\"user_\") !== -1) {\r\n              return {\r\n                ...acc,\r\n                user_info: {\r\n                  ...acc.user_info,\r\n                  [cur]: _post[cur],\r\n                },\r\n              };\r\n            }\r\n            return { ...acc, [cur]: _post[cur] };\r\n          },\r\n          {\r\n            id: doc.id,\r\n            user_info: {},\r\n          }\r\n        );\r\n        post_list.push(post);\r\n      });\r\n      console.log(post_list);\r\n      dispatch(setPost(post_list));\r\n    });\r\n  };\r\n};\r\n\r\n// 4번순서)리듀서만들기\r\nexport default handleActions(\r\n  {\r\n    [SET_POST]: (state, action) =>\r\n      // 어떤처리를 해줄지 적어주기\r\n      produce(state, (draft) => {\r\n        // 위에꺼가지고 어떤처리할지\r\n        draft.list = action.payload.post_list;\r\n      }),\r\n\r\n    [ADD_POST]: (state, action) =>\r\n      produce(state, (draft) => {\r\n        // unshift는 배열 맨 앞에 데이터를 넣어줘요!\r\n        draft.list.unshift(action.payload.post);\r\n      }),\r\n    [EDIT_POST]: (state, action) =>\r\n      produce(state, (draft) => {\r\n        let idx = draft.list.findIndex((p) => p.id === action.payload.post_id);\r\n\r\n        draft.list[idx] = { ...draft.list[idx], ...action.payload.post };\r\n      }),\r\n  },\r\n  initialState\r\n);\r\n\r\n// &3)export하기\r\nconst actionCreators = {\r\n  setPost,\r\n  addPost,\r\n  editPost,\r\n  getPostFB,\r\n  addPostFB,\r\n  editPostFB,\r\n};\r\n\r\nexport { actionCreators };\r\n"]},"metadata":{},"sourceType":"module"}